"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_typeof=require("@babel/runtime/helpers/typeof");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),React=_interopRequireWildcard(require("react")),_rcDrawer=_interopRequireDefault(require("rc-drawer")),_getScrollBarSize=_interopRequireDefault(require("rc-util/lib/getScrollBarSize")),_CloseOutlined=_interopRequireDefault(require("@ant-design/icons/CloseOutlined")),_classnames=_interopRequireDefault(require("classnames")),_configProvider=require("../config-provider"),_type=require("../_util/type"),_useForceUpdate=_interopRequireDefault(require("../_util/hooks/useForceUpdate"));function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!==_typeof(obj)&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}var __rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},DrawerContext=React.createContext(null),PlacementTypes=(0,_type.tuple)("top","right","bottom","left"),defaultPushState={distance:180},Drawer=React.forwardRef((function(_a,ref){var _a$width=_a.width,width=void 0===_a$width?256:_a$width,_a$height=_a.height,height=void 0===_a$height?256:_a$height,_a$closable=_a.closable,closable=void 0===_a$closable||_a$closable,_a$placement=_a.placement,placement=void 0===_a$placement?"right":_a$placement,_a$maskClosable=_a.maskClosable,maskClosable=void 0===_a$maskClosable||_a$maskClosable,_a$mask=_a.mask,mask=void 0===_a$mask||_a$mask,_a$level=_a.level,level=void 0===_a$level?null:_a$level,_a$keyboard=_a.keyboard,keyboard=void 0===_a$keyboard||_a$keyboard,_a$push=_a.push,_push=void 0===_a$push?defaultPushState:_a$push,_a$closeIcon=_a.closeIcon,closeIcon=void 0===_a$closeIcon?React.createElement(_CloseOutlined.default,null):_a$closeIcon,bodyStyle=_a.bodyStyle,drawerStyle=_a.drawerStyle,prefixCls=_a.prefixCls,className=_a.className,direction=_a.direction,visible=_a.visible,children=_a.children,zIndex=_a.zIndex,destroyOnClose=_a.destroyOnClose,style=_a.style,title=_a.title,headerStyle=_a.headerStyle,onClose=_a.onClose,footer=_a.footer,footerStyle=_a.footerStyle,rest=__rest(_a,["width","height","closable","placement","maskClosable","mask","level","keyboard","push","closeIcon","bodyStyle","drawerStyle","prefixCls","className","direction","visible","children","zIndex","destroyOnClose","style","title","headerStyle","onClose","footer","footerStyle"]),forceUpdate=(0,_useForceUpdate.default)(),_React$useState=React.useState(!1),_React$useState2=(0,_slicedToArray2.default)(_React$useState,2),internalPush=_React$useState2[0],setPush=_React$useState2[1],parentDrawer=React.useContext(DrawerContext),destroyClose=React.useRef(!1);React.useEffect((function(){return visible&&parentDrawer&&parentDrawer.push(),function(){parentDrawer&&parentDrawer.pull()}}),[]),React.useEffect((function(){parentDrawer&&(visible?parentDrawer.push():parentDrawer.pull())}),[visible]);var operations=React.useMemo((function(){return{push:function push(){_push&&setPush(!0)},pull:function pull(){_push&&setPush(!1)}}}),[_push]);React.useImperativeHandle(ref,(function(){return operations}),[operations]);var isDestroyOnClose=destroyOnClose&&!visible,onDestroyTransitionEnd=function onDestroyTransitionEnd(){isDestroyOnClose&&(visible||(destroyClose.current=!0,forceUpdate()))},getOffsetStyle=function getOffsetStyle(){if(!visible&&!mask)return{};var offsetStyle={};return"left"===placement||"right"===placement?offsetStyle.width=width:offsetStyle.height=height,offsetStyle};function renderHeader(){if(!title&&!closable)return null;var headerClassName="".concat(prefixCls,title?"-header":"-header-no-title");return React.createElement("div",{className:headerClassName,style:headerStyle},title&&React.createElement("div",{className:"".concat(prefixCls,"-title")},title),closable&&function renderCloseIcon(){return closable&&React.createElement("button",{type:"button",onClick:onClose,"aria-label":"Close",className:"".concat(prefixCls,"-close"),style:{"--scroll-bar":"".concat((0,_getScrollBarSize.default)(),"px")}},closeIcon)}())}var drawerClassName=(0,_classnames.default)((0,_defineProperty2.default)({"no-mask":!mask},"".concat(prefixCls,"-rtl"),"rtl"===direction),className),offsetStyle=mask?getOffsetStyle():{};return React.createElement(DrawerContext.Provider,{value:operations},React.createElement(_rcDrawer.default,(0,_extends2.default)({handler:!1},(0,_extends2.default)({placement:placement,prefixCls:prefixCls,maskClosable:maskClosable,level:level,keyboard:keyboard,children:children,onClose:onClose},rest),offsetStyle,{open:visible,showMask:mask,style:function getRcDrawerStyle(){var offsetStyle=mask?{}:getOffsetStyle();return(0,_extends2.default)((0,_extends2.default)({zIndex:zIndex,transform:internalPush?function getPushTransform(_placement){var distance;return distance="boolean"==typeof _push?_push?defaultPushState.distance:0:_push.distance,distance=parseFloat(String(distance||0)),"left"===_placement||"right"===_placement?"translateX(".concat("left"===_placement?distance:-distance,"px)"):"top"===_placement||"bottom"===_placement?"translateY(".concat("top"===_placement?distance:-distance,"px)"):void 0}(placement):void 0},offsetStyle),style)}(),className:drawerClassName}),function renderBody(){if(destroyClose.current&&!visible)return null;destroyClose.current=!1;var containerStyle={};return isDestroyOnClose&&(containerStyle.opacity=0,containerStyle.transition="opacity .3s"),React.createElement("div",{className:"".concat(prefixCls,"-wrapper-body"),style:(0,_extends2.default)((0,_extends2.default)({},containerStyle),drawerStyle),onTransitionEnd:onDestroyTransitionEnd},renderHeader(),React.createElement("div",{className:"".concat(prefixCls,"-body"),style:bodyStyle},children),function renderFooter(){if(!footer)return null;var footerClassName="".concat(prefixCls,"-footer");return React.createElement("div",{className:footerClassName,style:footerStyle},footer)}())}()))}));Drawer.displayName="Drawer";var DrawerWrapper=React.forwardRef((function(props,ref){var customizePrefixCls=props.prefixCls,customizeGetContainer=props.getContainer,_React$useContext=React.useContext(_configProvider.ConfigContext),getPopupContainer=_React$useContext.getPopupContainer,getPrefixCls=_React$useContext.getPrefixCls,direction=_React$useContext.direction,prefixCls=getPrefixCls("drawer",customizePrefixCls),getContainer=void 0===customizeGetContainer&&getPopupContainer?function(){return getPopupContainer(document.body)}:customizeGetContainer;return React.createElement(Drawer,(0,_extends2.default)({},props,{ref:ref,prefixCls:prefixCls,getContainer:getContainer,direction:direction}))}));DrawerWrapper.displayName="DrawerWrapper";var _default=DrawerWrapper;exports.default=_default;