"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_typeof=require("@babel/runtime/helpers/typeof");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck")),_createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass")),_inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits")),_createSuper2=_interopRequireDefault(require("@babel/runtime/helpers/createSuper")),React=_interopRequireWildcard(require("react")),_classnames=_interopRequireDefault(require("classnames")),_omit=_interopRequireDefault(require("rc-util/lib/omit")),_debounce=_interopRequireDefault(require("lodash/debounce")),_configProvider=require("../config-provider"),_type=require("../_util/type"),_reactNode=require("../_util/reactNode");function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!==_typeof(obj)&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}var __rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},SpinSizes=(0,_type.tuple)("small","default","large"),defaultIndicator=null;function renderIndicator(prefixCls,props){var indicator=props.indicator,dotClassName="".concat(prefixCls,"-dot");return null===indicator?null:(0,_reactNode.isValidElement)(indicator)?(0,_reactNode.cloneElement)(indicator,{className:(0,_classnames.default)(indicator.props.className,dotClassName)}):(0,_reactNode.isValidElement)(defaultIndicator)?(0,_reactNode.cloneElement)(defaultIndicator,{className:(0,_classnames.default)(defaultIndicator.props.className,dotClassName)}):React.createElement("span",{className:(0,_classnames.default)(dotClassName,"".concat(prefixCls,"-dot-spin"))},React.createElement("i",{className:"".concat(prefixCls,"-dot-item")}),React.createElement("i",{className:"".concat(prefixCls,"-dot-item")}),React.createElement("i",{className:"".concat(prefixCls,"-dot-item")}),React.createElement("i",{className:"".concat(prefixCls,"-dot-item")}))}function shouldDelay(spinning,delay){return!!spinning&&!!delay&&!isNaN(Number(delay))}var Spin=function(_React$Component){(0,_inherits2.default)(Spin,_React$Component);var _super=(0,_createSuper2.default)(Spin);function Spin(props){var _this;(0,_classCallCheck2.default)(this,Spin),(_this=_super.call(this,props)).debouncifyUpdateSpinning=function(props){var delay=(props||_this.props).delay;delay&&(_this.cancelExistingSpin(),_this.updateSpinning=(0,_debounce.default)(_this.originalUpdateSpinning,delay))},_this.updateSpinning=function(){var spinning=_this.props.spinning;_this.state.spinning!==spinning&&_this.setState({spinning:spinning})},_this.renderSpin=function(_ref2){var _classNames,getPrefixCls=_ref2.getPrefixCls,direction=_ref2.direction,_a=_this.props,customizePrefixCls=_a.prefixCls,className=_a.className,size=_a.size,tip=_a.tip,wrapperClassName=_a.wrapperClassName,style=_a.style,restProps=__rest(_a,["prefixCls","className","size","tip","wrapperClassName","style"]),spinning=_this.state.spinning,prefixCls=getPrefixCls("spin",customizePrefixCls),spinClassName=(0,_classnames.default)(prefixCls,(_classNames={},(0,_defineProperty2.default)(_classNames,"".concat(prefixCls,"-sm"),"small"===size),(0,_defineProperty2.default)(_classNames,"".concat(prefixCls,"-lg"),"large"===size),(0,_defineProperty2.default)(_classNames,"".concat(prefixCls,"-spinning"),spinning),(0,_defineProperty2.default)(_classNames,"".concat(prefixCls,"-show-text"),!!tip),(0,_defineProperty2.default)(_classNames,"".concat(prefixCls,"-rtl"),"rtl"===direction),_classNames),className),divProps=(0,_omit.default)(restProps,["spinning","delay","indicator"]),spinElement=React.createElement("div",(0,_extends2.default)({},divProps,{style:style,className:spinClassName}),renderIndicator(prefixCls,_this.props),tip?React.createElement("div",{className:"".concat(prefixCls,"-text")},tip):null);if(_this.isNestedPattern()){var containerClassName=(0,_classnames.default)("".concat(prefixCls,"-container"),(0,_defineProperty2.default)({},"".concat(prefixCls,"-blur"),spinning));return React.createElement("div",(0,_extends2.default)({},divProps,{className:(0,_classnames.default)("".concat(prefixCls,"-nested-loading"),wrapperClassName)}),spinning&&React.createElement("div",{key:"loading"},spinElement),React.createElement("div",{className:containerClassName,key:"container"},_this.props.children))}return spinElement};var spinning=props.spinning,shouldBeDelayed=shouldDelay(spinning,props.delay);return _this.state={spinning:spinning&&!shouldBeDelayed},_this.originalUpdateSpinning=_this.updateSpinning,_this.debouncifyUpdateSpinning(props),_this}return(0,_createClass2.default)(Spin,[{key:"componentDidMount",value:function componentDidMount(){this.updateSpinning()}},{key:"componentDidUpdate",value:function componentDidUpdate(){this.debouncifyUpdateSpinning(),this.updateSpinning()}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.cancelExistingSpin()}},{key:"cancelExistingSpin",value:function cancelExistingSpin(){var updateSpinning=this.updateSpinning;updateSpinning&&updateSpinning.cancel&&updateSpinning.cancel()}},{key:"isNestedPattern",value:function isNestedPattern(){return!(!this.props||void 0===this.props.children)}},{key:"render",value:function render(){return React.createElement(_configProvider.ConfigConsumer,null,this.renderSpin)}}],[{key:"setDefaultIndicator",value:function setDefaultIndicator(indicator){defaultIndicator=indicator}}]),Spin}(React.Component);Spin.defaultProps={spinning:!0,size:"default",wrapperClassName:""};var _default=Spin;exports.default=_default;