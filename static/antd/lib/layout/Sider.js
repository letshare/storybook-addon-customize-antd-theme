"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_typeof=require("@babel/runtime/helpers/typeof");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.SiderContext=void 0;var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),React=_interopRequireWildcard(require("react")),_classnames=_interopRequireDefault(require("classnames")),_omit=_interopRequireDefault(require("rc-util/lib/omit")),_BarsOutlined=_interopRequireDefault(require("@ant-design/icons/BarsOutlined")),_RightOutlined=_interopRequireDefault(require("@ant-design/icons/RightOutlined")),_LeftOutlined=_interopRequireDefault(require("@ant-design/icons/LeftOutlined")),_layout=require("./layout"),_configProvider=require("../config-provider"),_isNumeric=_interopRequireDefault(require("../_util/isNumeric"));function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!==_typeof(obj)&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}var __rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},dimensionMaxMap={xs:"479.98px",sm:"575.98px",md:"767.98px",lg:"991.98px",xl:"1199.98px",xxl:"1599.98px"},SiderContext=React.createContext({});exports.SiderContext=SiderContext;var generateId=function(){var i=0;return function(){var prefix=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return i+=1,"".concat(prefix).concat(i)}}(),Sider=React.forwardRef((function(_a,ref){var customizePrefixCls=_a.prefixCls,className=_a.className,trigger=_a.trigger,children=_a.children,_a$defaultCollapsed=_a.defaultCollapsed,defaultCollapsed=void 0!==_a$defaultCollapsed&&_a$defaultCollapsed,_a$theme=_a.theme,theme=void 0===_a$theme?"dark":_a$theme,_a$style=_a.style,style=void 0===_a$style?{}:_a$style,_a$collapsible=_a.collapsible,collapsible=void 0!==_a$collapsible&&_a$collapsible,_a$reverseArrow=_a.reverseArrow,reverseArrow=void 0!==_a$reverseArrow&&_a$reverseArrow,_a$width=_a.width,width=void 0===_a$width?200:_a$width,_a$collapsedWidth=_a.collapsedWidth,collapsedWidth=void 0===_a$collapsedWidth?80:_a$collapsedWidth,zeroWidthTriggerStyle=_a.zeroWidthTriggerStyle,breakpoint=_a.breakpoint,onCollapse=_a.onCollapse,onBreakpoint=_a.onBreakpoint,props=__rest(_a,["prefixCls","className","trigger","children","defaultCollapsed","theme","style","collapsible","reverseArrow","width","collapsedWidth","zeroWidthTriggerStyle","breakpoint","onCollapse","onBreakpoint"]),siderHook=(0,React.useContext)(_layout.LayoutContext).siderHook,_useState=(0,React.useState)("collapsed"in props?props.collapsed:defaultCollapsed),_useState2=(0,_slicedToArray2.default)(_useState,2),collapsed=_useState2[0],setCollapsed=_useState2[1],_useState3=(0,React.useState)(!1),_useState4=(0,_slicedToArray2.default)(_useState3,2),below=_useState4[0],setBelow=_useState4[1];(0,React.useEffect)((function(){"collapsed"in props&&setCollapsed(props.collapsed)}),[props.collapsed]);var handleSetCollapsed=function handleSetCollapsed(value,type){"collapsed"in props||setCollapsed(value),null==onCollapse||onCollapse(value,type)},responsiveHandlerRef=(0,React.useRef)();responsiveHandlerRef.current=function(mql){setBelow(mql.matches),null==onBreakpoint||onBreakpoint(mql.matches),collapsed!==mql.matches&&handleSetCollapsed(mql.matches,"responsive")},(0,React.useEffect)((function(){function responsiveHandler(mql){return responsiveHandlerRef.current(mql)}var mql;if("undefined"!=typeof window){var matchMedia=window.matchMedia;if(matchMedia&&breakpoint&&breakpoint in dimensionMaxMap){mql=matchMedia("(max-width: ".concat(dimensionMaxMap[breakpoint],")"));try{mql.addEventListener("change",responsiveHandler)}catch(error){mql.addListener(responsiveHandler)}responsiveHandler(mql)}}return function(){try{null==mql||mql.removeEventListener("change",responsiveHandler)}catch(error){null==mql||mql.removeListener(responsiveHandler)}}}),[]),(0,React.useEffect)((function(){var uniqueId=generateId("ant-sider-");return siderHook.addSider(uniqueId),function(){return siderHook.removeSider(uniqueId)}}),[]);var toggle=function toggle(){handleSetCollapsed(!collapsed,"clickTrigger")},getPrefixCls=(0,React.useContext)(_configProvider.ConfigContext).getPrefixCls;return React.createElement(SiderContext.Provider,{value:{siderCollapsed:collapsed}},function renderSider(){var _classNames,prefixCls=getPrefixCls("layout-sider",customizePrefixCls),divProps=(0,_omit.default)(props,["collapsed"]),rawWidth=collapsed?collapsedWidth:width,siderWidth=(0,_isNumeric.default)(rawWidth)?"".concat(rawWidth,"px"):String(rawWidth),zeroWidthTrigger=0===parseFloat(String(collapsedWidth||0))?React.createElement("span",{onClick:toggle,className:(0,_classnames.default)("".concat(prefixCls,"-zero-width-trigger"),"".concat(prefixCls,"-zero-width-trigger-").concat(reverseArrow?"right":"left")),style:zeroWidthTriggerStyle},trigger||React.createElement(_BarsOutlined.default,null)):null,defaultTrigger={expanded:reverseArrow?React.createElement(_RightOutlined.default,null):React.createElement(_LeftOutlined.default,null),collapsed:reverseArrow?React.createElement(_LeftOutlined.default,null):React.createElement(_RightOutlined.default,null)}[collapsed?"collapsed":"expanded"],triggerDom=null!==trigger?zeroWidthTrigger||React.createElement("div",{className:"".concat(prefixCls,"-trigger"),onClick:toggle,style:{width:siderWidth}},trigger||defaultTrigger):null,divStyle=(0,_extends2.default)((0,_extends2.default)({},style),{flex:"0 0 ".concat(siderWidth),maxWidth:siderWidth,minWidth:siderWidth,width:siderWidth}),siderCls=(0,_classnames.default)(prefixCls,"".concat(prefixCls,"-").concat(theme),(_classNames={},(0,_defineProperty2.default)(_classNames,"".concat(prefixCls,"-collapsed"),!!collapsed),(0,_defineProperty2.default)(_classNames,"".concat(prefixCls,"-has-trigger"),collapsible&&null!==trigger&&!zeroWidthTrigger),(0,_defineProperty2.default)(_classNames,"".concat(prefixCls,"-below"),!!below),(0,_defineProperty2.default)(_classNames,"".concat(prefixCls,"-zero-width"),0===parseFloat(siderWidth)),_classNames),className);return React.createElement("aside",(0,_extends2.default)({className:siderCls},divProps,{style:divStyle,ref:ref}),React.createElement("div",{className:"".concat(prefixCls,"-children")},children),collapsible||below&&zeroWidthTrigger?triggerDom:null)}())}));Sider.displayName="Sider";var _default=Sider;exports.default=_default;